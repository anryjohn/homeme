{{extend 'layout.html'}}
<script src="https://use.fontawesome.com/2a89db6bb1.js"></script>
<link rel="stylesheet" href="{{=URL('static','css/index.css')}}"/>

<div class="navbar">
    <div class="logo">
        <img src="http://i.imgur.com/yRFFTxA.jpg" height="50px"/>
    </div>

    <nav>
        <a href="{{=URL('default', 'aboutus')}}">About Us</a>
        {{if auth.user_id:}}
        <a href="{{=URL('default', 'profile')}}">Profile</a>
        <a href="{{=URL('default', 'index')}}">Postings</a>
        <a href="{{=URL('default', 'user', args=['logout'])}}">Logout</a>
        {{else:}}
        <a href="{{=URL('default', 'user', args=['login'])}}"> Login</a>
        {{pass}}
    </nav>
</div>

<div class="post_listing center">
{{if auth.user_id:}}

    <div class="profile-search">
        <center>
            <h4>Search for a user:</h4>
            {{=form}}
        </center>
            {{if people:}}
            <h4 align="left">Results:</h4>
            <table>
                {{for user in people:}}
                    <tr>
                        <td>{{=A(name_of(user), _href=URL('profile',args=user.id))}}</td>
                    </tr>
                {{pass}}
            </table>
            {{pass}}
        <a href="{{=URL('default', 'search')}}" type="button" class="btn btn-primary"> Advanced search</a>
    </div>

    <a href="{{=URL('default', 'edit')}}" type="button" class="btn btn-primary">
        <i class="fa fa-plus"></i> Post as Tenant</a>
    <a href="{{=URL('default', 'edit_Landlord')}}" type="button" class="btn btn-primary">
        <i class="fa fa-plus"></i> Post as Landlord</a>
    <a href="{{=URL('default', 'profile')}}" type="button" class="btn btn-info">
        <i class="fa fa-user-circle" aria-hidden="true"></i> View my profile</a>


{{else:}}

    <div class="post_list_header text-right">
        <a href="{{=URL('default', 'user', args=['login'])}}" class="btn btn-warning">Log In</a>
    </div>


{{pass}}

	<div class="tab">
        <div class="dropdown">
          <button class="dropbtn">View as</button>
          <div class="dropdown-content">
            <button class="tablinks" onclick="openTab(event, 'tenant')">Tenant Listings</button>
            <button class="tablinks" onclick="openTab(event, 'landlord')">Landlord Listings</button>
            <button class="tablinks" onclick="openTab(event, 'all')" id="defaultOpen">View All</button>
          </div>
        </div>
    </div>

    <!--<div class="dropdown">
      <button class="dropbtn">View as</button>
      <div class="dropdown-content">
        <button class="tablinks" onclick="openTab(event, 'tenant')">Tenant Listings</button>
        <button class="tablinks" onclick="openTab(event, 'landlord')">Landlord Listings</button>
        <button class="tablinks" onclick="openTab(event, 'all')" id="defaultOpen">View All</button>
      </div>
    </div>-->

    <div id="tenant" class="tabcontent">
	    <div class="post_list1">
	    {{for p in posts:}}
	        <!--
	        old code:
	        div class="post1 text-left">
	       -->
	        <div class="post1 text-left">
	            <!-- Here goes the code to display an individual post. The code below is just a placeholder. -->
	            <h3>{{=p.post_content}}</h3>
				      <strong>Budget:</strong> ${{=p.min_budget}} to ${{=p.max_budget}}
	            </p>
	            <p><strong>Description:</strong> {{=p.description}}
	            </p>
                <p><strong>Number of People:</strong> {{=p.number_of_people}}
	            </p>

	            <div class="post_details text-left">

	                Posted by: <a href="{{=URL('default', 'profile', args=p.id)}}">{{=firstlast(p.user_email)}}</a>
	                at <em>{{=p.created_on.hour}}:{{=p.created_on.minute}}</em>

	                {{if p.created_on == p.updated_on:}}
	                    <em>on {{=p.created_on.month}}/{{=p.created_on.day}}/{{=p.created_on.year}}</em>

	                {{else:}}
	                    <br> and edited
	                    {{=p.updated_on.hour}}:{{=p.updated_on.minute}} on
	                    {{=p.updated_on.month}}/{{=p.updated_on.day}}/{{=p.updated_on.year}}
	                {{pass}}

	                {{if auth.user is not None:}}
	                    {{if p.user_email == auth.user.email:}}
	                        | <a href="{{=URL('default', 'edit', args=[p.id], vars=dict(edit='true'))}}">
	                            Click to edit
	                        </a>
	                    {{pass}}
	                {{pass}}
	            </div>
	        </div>
	    	{{pass}}
		</div>
		{{pass}}
	</div>

	<div id="landlord" class="tabcontent">
	    <div class="post_list1">
	    	{{for p in posts2:}}

	        <div class="post1 text-left">
	            <!-- Here goes the code to display an individual post. The code below is just a placeholder. -->
	            {{if p.picture:}} <p><img src="{{=URL('default', 'download', args=p.picture)}}" width="30%"/></p>
	            {{else: }} <p><h3>No picture uploaded.</h3></p>
	            {{pass}}

	            {{if p.my_address:}}
	              <p><strong>Location: </strong>{{=p.my_address}} {{=p.my_city}}, {{=p.my_state}}</p>
	            {{else: }}
	            {{pass}}

	            {{if p.sq_ft:}}
	              <p><strong>Square feet: </strong> {{=p.sq_ft}}</p>
	            {{else:}}
	            {{pass}}

	            {{if p.num_bed and p.num_bath:}}
	            <p><strong>Bed/bath: </strong> {{=p.num_bed}} beds and {{=p.num_bath}} baths</p>
	            {{pass}}

	            {{if p.washdry:}}<p><strong>Washer: </strong>
	            {{if p.washdry == False:}} No
	            {{else:}} Yes
	            {{pass}}
	            {{pass}}
	            </p>

	            {{if p.pets:}}
	            <p><strong>Pets: </strong>
	            {{if p.pets == False:}} No
	            {{else:}} Yes
	            {{pass}}
	            {{pass}}
	            </p>

	            {{if p.furnish:}}
	            <p><strong>Furnished: </strong>
	            {{if p.furnish == False:}} No
	            {{else:}} Yes
	            {{pass}}
	            {{pass}}
	            </p>

	            {{if p.more_info:}}
	            <p><strong>More info: </strong> {{=p.more_info}} </p>
	            {{pass}}

	            <div class="post_details text-left">

	                Posted by: <a href="{{=URL('default', 'profile', args=p.id)}}">{{=firstlast(p.user_email)}}</a>
	                at <em>{{=p.createdon.hour}}:{{=p.createdon.minute}}</em>

	                {{if p.createdon == p.updatedon:}}
	                    <em>on {{=p.createdon.month}}/{{=p.createdon.day}}/{{=p.createdon.year}}</em>

	                {{else:}}
	                    <br> and edited
	                    {{=p.updatedon.hour}}:{{=p.updatedon.minute}} on
	                    {{=p.updatedon.month}}/{{=p.updatedon.day}}/{{=p.updatedon.year}}
	                {{pass}}

	                {{if auth.user is not None:}}
	                    {{if p.user_email == auth.user.email:}}
	                        | <a href="{{=URL('default', 'edit', args=[p.id], vars=dict(edit='true'))}}">
	                            Click to edit
	                        </a>
	                    {{pass}}
	                {{pass}}
	            </div>
	        </div>
	    {{pass}}
	    </div>
	</div>

	<div id="all" class="tabcontent">
    	<div class="profilelan" style="width:45%;padding:0 10pt 0 0;float:right;">
        	<strong>Tenant Posts</strong><br>
        	<div class="post_list1">
		    {{for p in posts:}}
		        <!--
		        old code:
		        div class="post1 text-left">
		       -->
		        <div class="post1 text-left">
		            <!-- Here goes the code to display an individual post. The code below is just a placeholder. -->
		            <h3>{{=p.post_content}}</h3>

		                <strong>Budget:</strong> ${{=p.min_budget}} to ${{=p.max_budget}}
		                </p>

		                <p><strong>Description:</strong> {{=p.description}}
		                </p>

		                <p><strong>Number of People:</strong> {{=p.number_of_people}}
		                </p>

		            <div class="post_details text-left">

		                Posted by: <a href="{{=URL('default', 'profile', args=p.id)}}">{{=firstlast(p.user_email)}}</a>
		                at <em>{{=p.created_on.hour}}:{{=p.created_on.minute}}</em>

		                {{if p.created_on == p.updated_on:}}
		                    <em>on {{=p.created_on.month}}/{{=p.created_on.day}}/{{=p.created_on.year}}</em>

		                {{else:}}
		                    <br> and edited
		                    {{=p.updated_on.hour}}:{{=p.updated_on.minute}} on
		                    {{=p.updated_on.month}}/{{=p.updated_on.day}}/{{=p.updated_on.year}}
		                {{pass}}

		                {{if auth.user is not None:}}
		                    {{if p.user_email == auth.user.email:}}
		                        | <a href="{{=URL('default', 'edit', args=[p.id], vars=dict(edit='true'))}}">
		                            Click to edit
		                        </a>
		                    {{pass}}
		                {{pass}}
		            </div>
		        </div>
		    	{{pass}}
			</div>
			{{pass}}
		</div>

		<div class="profilelan" style="width:45%;padding:0 10pt 0 0;float:left;">
        	<strong>Profile Posts</strong><br>
        	<div class="post_list1">
	    		<h3>Buggy landlord posting</h3>
	    		{{for p in posts2:}}

		        <div class="post1 text-left">
		            <!-- Here goes the code to display an individual post. The code below is just a placeholder. -->
		            {{if p.picture:}} <p><img src="{{=URL('default', 'download', args=p.picture)}}" width="30%"/></p>
		            {{else: }} <p><h3>No picture uploaded.</h3></p>
		            {{pass}}

		            {{if p.my_address:}}
		              <p><strong>Location: </strong>{{=p.my_address}} {{=p.my_city}}, {{=p.my_state}}</p>
		            {{else: }}
		            {{pass}}

		            {{if p.sq_ft:}}
		              <p><strong>Square feet: </strong> {{=p.sq_ft}}</p>
		            {{else:}}
		            {{pass}}

		            {{if p.num_bed and p.num_bath:}}
		            <p><strong>Bed/bath: </strong> {{=p.num_bed}} beds and {{=p.num_bath}} baths</p>
		            {{pass}}

		            {{if p.washdry:}}<p><strong>Washer: </strong>
		            {{if p.washdry == False:}} No
		            {{else:}} Yes
		            {{pass}}
		            {{pass}}
		            </p>

		            {{if p.pets:}}
		            <p><strong>Pets: </strong>
		            {{if p.pets == False:}} No
		            {{else:}} Yes
		            {{pass}}
		            {{pass}}
		            </p>

		            {{if p.furnish:}}
		            <p><strong>Furnished: </strong>
		            {{if p.furnish == False:}} No
		            {{else:}} Yes
		            {{pass}}
		            {{pass}}
		            </p>

		            {{if p.more_info:}}
		            <p><strong>More info: </strong> {{=p.more_info}} </p>
		            {{pass}}

		            <div class="post_details text-left">

		                Posted by: <a href="{{=URL('default', 'profile', args=p.id)}}">{{=firstlast(p.user_email)}}</a>
		                at <em>{{=p.createdon.hour}}:{{=p.createdon.minute}}</em>

		                {{if p.createdon == p.updatedon:}}
		                    <em>on {{=p.createdon.month}}/{{=p.createdon.day}}/{{=p.createdon.year}}</em>

		                {{else:}}
		                    <br> and edited
		                    {{=p.updatedon.hour}}:{{=p.updatedon.minute}} on
		                    {{=p.updatedon.month}}/{{=p.updatedon.day}}/{{=p.updatedon.year}}
		                {{pass}}

		                {{if auth.user is not None:}}
		                    {{if p.user_email == auth.user.email:}}
		                        | <a href="{{=URL('default', 'edit', args=[p.id], vars=dict(edit='true'))}}">
		                            Click to edit
		                        </a>
		                    {{pass}}
		                {{pass}}
		            </div>
		        </div>
	    	{{pass}}
    		</div>
    	</div>
    </div>

	<script>
    document.getElementById("defaultOpen").click();

    function openTab(evt, poster) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }

        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }

        document.getElementById(poster).style.display = "block";
        evt.currentTarget.className += " active";
    }
    </script>

</div>
